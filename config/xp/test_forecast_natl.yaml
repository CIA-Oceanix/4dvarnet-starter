# @package _global_
xpd: ???


xp_overrides:
  datamodule:
    input_da:
      _target_: src.utils.load_altimetry_data
      path: data/natl_w_7nadirs.nc
    domains:
      train:
        time: {_target_: builtins.slice, _args_: ['2013-02-24', '2013-09-30']}
      val:
        time: {_target_: builtins.slice, _args_: ['2012-12-15', '2013-02-24']}
      test:  # WARN: test period on all natl dataset, use with training on enatl or ose
        time: {_target_: builtins.slice, _args_: ['2012-10-01', '2013-09-30']}

trainer:
  _target_: pytorch_lightning.Trainer
  inference_mode: False
  accelerator: gpu
  devices: 1
  logger: False

lit_mod:
  _target_: contrib.multi_domain_diag.load_cfg_from_xp
  key: model
  xpd : ${xpd}
  overrides: ${xp_overrides}

dm:
  _target_: contrib.multi_domain_diag.load_cfg_from_xp
  key: datamodule
  xpd : ${xpd}
  overrides: ${xp_overrides}

ckpt:
  _target_: src.utils.best_ckpt
  xp_dir: ${xpd}

entrypoints:
  - _target_: pytorch_lightning.seed_everything
    seed: 333
  - _target_: pytorch_lightning.Trainer.test
    self: ${trainer}
    model: ${lit_mod}
    datamodule: ${dm}
    ckpt_path: ${ckpt}

defaults:
  - _self_

